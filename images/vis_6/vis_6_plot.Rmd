---
title: "vis6prices"
author: "Joseph Beltran"
date: "August 2, 2016"
output: html_document
---

```{r}
library(ggplot2)
library(dplyr)

four_cities <- read.csv("updated_cleaned_four_cities.csv")

four_cities <- four_cities %>% 
  mutate(Price.Range = (Price)) %>% 
  mutate(Price.Range = ifelse(Price < 50, "0-49", Price)) %>% 
  mutate(Price.Range = ifelse(Price >= 50 & Price < 100, "50-99", as.character(Price.Range))) %>% 
  mutate(Price.Range = ifelse(Price >= 100 & Price < 200, "100-199", as.character(Price.Range))) %>% 
mutate(Price.Range = ifelse(Price >= 200 & Price < 300, "200-299", as.character(Price.Range))) %>% 
  mutate(Price.Range = ifelse(Price >= 300, "300+", as.character(Price.Range)))
four_cities$Price.Range <- factor(four_cities$Price.Range, levels = c("0-49", "50-99", "100-199", "200-299", "300+"))

levels(four_cities$Cancellation.Policy) <- c("Flexible", "Moderate", "Strict", "Unspecified")

city_names <- c(
                    `ch` = "Chicago",
                    `la` = "Los Angeles",
                    `ny` = "New York",
                    `sf` = "San Francisco"
                    )

ggplot(four_cities) +
  geom_histogram(aes(Price, fill = Cancellation.Policy), binwidth = 10) +
  facet_wrap(~City, labeller = as_labeller(city_names)) +
  labs(x = "Price Range (in USD)",
       y = "Count",
       title = "Price Range Summary of Airbnb Rooms"
  ) +
  scale_fill_discrete(name = "Cancellation Policy") +
  scale_x_continuous(limits = c(0, 450), breaks = seq(0, 450, 90)) 

ggplot(four_cities) +
  geom_bar(aes(Cancellation.Policy, fill = Price.Range)) +
  facet_wrap(~City, labeller = as_labeller(city_names)) +
  labs(x = "Price Range (in USD)",
       y = "Count",
       title = "Price Range Summary of Airbnb Rooms"
  ) +
  scale_fill_discrete(name = "Price Range")


```

