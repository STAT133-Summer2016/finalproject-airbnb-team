---
title: "4 cities"
author: "judy teng"
date: "July 30, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#sf 

sf_df <- read.xls("SFdf")
  sf_df <- sf_df %>%
    mutate(e= c(1:1782))
  
#sf_prices <- read_csv("SFprices")         sf prices and ids not needed; already in sf_df
#sf_prices <- sf_prices[-c(1:18),]
 # sf_prices <- sf_prices %>%
  #  mutate(e = c(1:1782))
  
#sf_ids <- read_csv("SFids")
 # sf_ids <- sf_ids %>%
  #  mutate(e = c(1:1782))

sf_final <- sf_df %>%
  mutate(city = "sf")

```



```{r}
# new york city
ny_df <- read.xls("NYdf") %>%
  ny_df <- ny_df %>%
  mutate(e= c(1:1800))

#ny_prices <- read_csv("NYprices")        ny price & id not needed; alreading in ny_df
  #ny_prices <- ny_prices %>%
  #mutate(e= c(1:1800))

#ny_ids <- read_csv("NYids") 
  #ny_ids <- ny_ids  %>%
  #mutate(e = c(1:1800))
ny_final <- ny_df %>%
  mutate(city = "nyc")
```


```{r}
#los angeles 
la_df <- read.xls("LAdf")
  la_df <- la_df %>%
    mutate(e = c(1:1800))
  
#la_prices <- read_csv("LAprices")      la price and ids not needed; already in la_df
 # la_prices <- la_prices %>%
  #  mutate(e = c(1:1800))
  
#la_ids <- read_csv("LAids")
 # la_ids <- la_ids %>%
  #  mutate(e = c(1:1800))
  
la_final <- la_df %>%
  mutate(city = "la")
```


```{r}
#chicago

ch_df <- read.xls("Chicagodf.xls")
  ch_df <- ch_df %>%
    mutate(e= c(1:1799))
  
#ch_prices <- read.csv("Chicagoprices")       chicago id and price not needed, already in ch_df
#ch_prices <- ch_prices[-1,] %>%
 # as.data.frame() %>%
  #  mutate(e = c(1:1799))
#colnames(ch_prices) <- c("pricelistings","e")

#ch_ids <- read.csv("Chicagids")       
#ch_ids <- ch_ids[-1,] %>%
 # as.data.frame() %>%
  #  mutate(e = c(1:1799))

ch_final <- ch_df %>%
  full_join(ch_prices) %>%
  mutate(city = "ch")
```


```{r}
# csv outputs; sf, nyc, la, chica, 4 cities

sf_cols <- names(sf_final)
la_cols <- names(la_final)
ny_cols <- names(ny_final)
ch_cols <- names(ch_final)

# this code finds mutual columns between the four data frames: sf_final, la_final, ch_final, ny_final
sf_common_cols <- sf_cols[sf_cols %in% la_cols]
ny_common_cols <- ny_cols[ny_cols %in% la_cols]
ch_common_cols <- ch_cols[ch_cols %in% la_cols]
la_common_cols <- la_cols

sf_final_2 <- sf_final %>%
  select(Accommodates, Bathrooms, Bedrooms, Beds, Check.In, Check.Out, 
         Property.type, Room.type, Extra.people, Weekly.discount, 
         Monthly.discount, Cancellation, Response.time, ID, price, e, city)
write_csv(sf_final_2, path = "cleaned_sf")

la_final_2 <- la_final %>%
  select(Accommodates, Bathrooms, Bedrooms, Beds, Check.In, Check.Out, 
         Property.type, Room.type, Extra.people, Weekly.discount, 
         Monthly.discount, Cancellation, Response.time, ID, price, e, city)
write_csv(la_final_2, path = "cleaned_la")

ch_final_2 <- ch_final %>%
  select(Accommodates, Bathrooms, Bedrooms, Beds, Check.In, Check.Out, 
         Property.type, Room.type, Extra.people, Weekly.discount, 
         Monthly.discount, Cancellation, Response.time, ID, price, e, city)
write_csv(ch_final_2, path = "cleaned_ch")

ny_final_2 <- ny_final %>%
  select(Accommodates, Bathrooms, Bedrooms, Beds, Check.In, Check.Out, 
         Property.type, Room.type, Extra.people, Weekly.discount, 
         Monthly.discount, Cancellation, Response.time, ID, price, e, city)
ny_final_2 <- ny_final_2[,-c(1,2)]
write_csv(ny_final_2, path = "cleaned_ny")

four_cities <- rbind(sf_final_2,ny_final_2) %>%
  rbind(la_final_2) %>%
  rbind(ch_final_2)
  
write_csv(four_cities, path = "four_cities")  
```





